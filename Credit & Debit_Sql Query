create database CREDIT;
use credit ;

/*TOTAL AMOUNT */
SELECT 
  SUM(Amount) AS Total_Amount
FROM banking_data;

/* 1- TOTAL CREDIT AMOUNT */
SELECT 
  SUM(Amount) AS Total_Credit
FROM banking_data
WHERE `Transaction Type` = 'Credit';

/* 2- TOTAL DEBIT AMOUNT */
SELECT 
  SUM(Amount) AS Total_Debit
FROM banking_data
WHERE `Transaction Type` = 'Debit';


/* 3 - Net-Transaction */
select  
 Round(
	sum(case when `transaction type`= 'credit'then amount else 0 end)-
	sum(case when `transaction type`= 'debit'then amount else 0 end),2) 
    as Net_Transaction_Amount from banking_data;


/* 4) credit-debit ratio */
SELECT 
  ROUND(
    SUM(CASE WHEN `transaction type` = 'credit' THEN amount ELSE 0 END) /
    SUM(CASE WHEN `transaction type` = 'debit' THEN amount ELSE 0 END),
    2
  ) AS Credit_Debit_Ratio
FROM banking_data;


/*5  Account Activity Ratio */
SELECT
    `Customer ID`,
    COUNT(`Customer ID`) AS Total_transactions,
    MAX(`Balance`) AS Current_balance,
    ROUND(COUNT(`Customer ID`) / NULLIF(MAX(`Balance`), 0), 5) AS account_activity_ratio
FROM
    banking_data
GROUP BY
   `Customer ID`
   Order by
   account_activity_ratio desc;
   
   
   /*  6 - Transaction per Day/Month/Week */
   
   SELECT 
  `Transaction Date`,
  COUNT(*) AS Transactions_Per_Day
FROM banking_data
GROUP BY `Transaction Date`
ORDER BY `Transaction Date`;

   
  /* 7  TOTAL TRANSACTION AMOUNT BY BRANCH */
  SELECT 
  Branch,
 round(
 SUM(Amount),2)
 AS Total_Transaction_Amount
FROM banking_data
GROUP BY Branch
ORDER BY Total_Transaction_Amount DESC;

  

/* 8- Transaction volume by Bank */
select * from banking_data;
select count(*) from banking_data;
select `Bank Name`, round(sum(amount),2)
as Total_Amount from banking_data 
group by `Bank Name` 
order by Total_Amount desc;


/* 11 -  HIGHT RISK TRANSACTION */
use credit;
SELECT 
    `Customer ID`,
    `Account Number`,
    Amount,
    `Transaction Type`,
    `Transaction Date`,
    CASE 
        WHEN Amount > 4500 THEN 'High-Risk'  -- Threshold: â‚¹50,000
        WHEN `Transaction Type` = 'withdrawal' AND Amount > 4500 
        THEN 'High-Risk'  -- Example of large withdrawals
        ELSE 'normal'
    END AS risk_flag
FROM banking_data
ORDER BY `Transaction Date` DESC;


/* 12-  Suspicious Transaction Frequency */
use credit;
SELECT 
  DATE_FORMAT(`Transaction Date`, '%Y-%m-01') as transaction_month,
  COUNT(*) AS high_risk_transaction_count
FROM banking_data
WHERE 
  (amount > 4500)
   OR (LOWER(`Transaction Type`) = 'withdrawal')
GROUP BY DATE_FORMAT(`Transaction Date`, '%Y-%m-01');

